{% extends 'base.html' %}
{% block content %}
    <h1>Welcome to My Blog</h1>
    <div class="posts">
        {% for post in posts %}
            <div class="post" id="post-{{ post.id }}">
                <h2>{{ post.title }}</h2>
                <p class="post-date">{{ post.date }}</p>
                <p>
                    {% if post.content|length > 500 %}
                        {{ post.content[:500] }}...
                        <a href="{{ url_for('view_post', post_id=post.id) }}">Read more</a>
                    {% else %}
                        {{ post.content }}
                    {% endif %}
                </p>
                {% if post.image_urls %}
                    {% for image_url in post.image_urls %}
                        <img src="{{ image_url }}" alt="Post Image">
                    {% endfor %}
                {% endif %}
                <button class="like-button" data-post-id="{{ post.id }}">Like (<span class="like-count" id="like-count-{{ post.id }}">{{ post.get('likes', 0) }}</span>)</button>
            </div>
        {% endfor %}
    </div>
    <script>
        $(document).ready(function(){
            $('.like-button').click(function(){
                var postId = $(this).data('post-id');
                $.post('/like/' + postId, function(data){
                    $('#like-count-' + postId).text(data.likes);
                });
            });
        });
    </script>
{% endblock %}
