{% extends 'base.html' %}
{% block title %}Home - My Blog{% endblock %}

{% block header %}
<header>
    <img src="/static/uploads/profile.jpg" alt="Profile Picture" class="header-image">
</header>
{% endblock %}

{% block content %}
    <h1>Welcome to My Blog</h1>
    <div class="posts">
        {% for post in posts %}
            <div class="post" id="post-{{ post.id }}">
                <div class="post-content">
                    <h2>{{ post.title }}</h2>
                    <p class="post-id">Post ID: {{ post.id }}</p> <!-- Display post ID -->
                    <p class="post-date">{{ post.date }}</p>
                    <p>
                        {% if post.content|length > 100 %}
                            {{ post.content[:100] }}...
                            <a href="{{ url_for('view_post', post_id=post.id) }}">Read more</a>
                        {% else %}
                            {{ post.content }}
                        {% endif %}
                    </p>
    <!--                <a href="{{ url_for('edit_post', post_id=post.id) }}">Edit</a> &lt;!&ndash; Edit button &ndash;&gt;-->
                    <button class="like-button" data-post-id="{{ post.id }}">
                            <span class="like-count" id="like-count-{{ post.id }}">{{ post.get('likes', 0) }}</span> <i class="fas fa-thumbs-up"></i>
                        </button>
                </div>
                {% if post.image_urls %}
                    <div class="post-images">
                        {% for image_url in post.image_urls %}
                            <img src="{{ image_url }}" alt="Post Image">
                        {% endfor %}
                    </div>
                {% endif %}
            </div>
        {% endfor %}
    </div>
<script>
$(document).ready(function(){
    $('.like-button').click(function(){
        var postId = $(this).data('post-id');
        $.post('/like/' + postId, function(data){
            $('#like-count-' + postId).text(data.likes);
        });
        $(this).prop('disabled', true); // Disable the button after clicking
    });
});

</script>
{% endblock %}
